$(document).ready(function () {
    // Handle Add to Wishlist and Cart
    $(document).on('click', '.add-item', function () {
        const button = $(this);
        const actionName = button.data('action-name');
        const productId = button.data('product-id');
        const productVariantId = button.data('product-variant-id');

        $.ajax({
            url: itemActionStoreUrl, // Use a global variable instead of Blade syntax
            type: 'POST',
            data: {
                action_name: actionName,
                product_id: productId,
                product_variant_id: productVariantId,
                _token: csrfToken // Use a global variable for CSRF token
            },
            success: function (response) {
                button.toggleClass('bg-dark text-white', response.message.includes('Added'));
                $('#wishlist-count').text(response.count_wishlist || $('#wishlist-count').text());
                $('#cart-count').text(response.count_cart || $('#cart-count').text());
            },
            error: function (xhr) {
                switch (xhr.status) {
                    case 401: // User not authenticated
                        window.location.href = loginUrl; // Use a global variable for login URL
                        break;
                    case 404:
                        alert('Product not found.');
                        break;
                    default:
                        alert('An error occurred. Please try again.');
                }
            }
        });
    });
});
